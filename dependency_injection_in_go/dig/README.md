* 依赖注入 dig 的使用场景：
* 1） 作为支持框架管理代码依赖关系的插件部分，不能替代框架
* 2 ) 因为dig 使用反射机制，依赖注入的使用最好是在进程启动阶段，不能在进程启动后返回 被频繁使用（受限于设计机制性能的影响）。
* 3 ) 可以在进程启动时解析依赖对象图，提升应用启动的稳定性和可维护性。
  
#
* 安装 dig 命令：  go get -u -v go.uber.org/dig@v1
* 如何使用：
* 1）  dig.New() 创建一个container, 该容器内管理注入的类型变量值。是类型和依赖关系组成的有向无环图。
* 1） Provide(func)  是 container 定义 如何 构建一个或多个类型的 值对象。该函数调用不触发创建。
* Provide() 中的 func；该 func的返回值是创建的值对象， func()的入参是依赖项。
* 生成的值对象只会产生一次,函数发生调用的时候是：该函数创建一个类型或者被 Invoke()调用时，即使该函数被调用多次。
* func 函数的入参（作为依赖项）可以是0，1，..多个类型，也可以是一个嵌入了 dig.In的结构体类型（匿名嵌入, 结构体每个成员都是独立依赖项,整体作为参数对象）。
*  函数的参数对象（嵌入dig.In的入参结构体） 中成员 使用 可选依赖： optional:"true"， 说明依赖项不是必须的，即使没有提供该成员的provide()函数，也可以创建其返回值对象。
*  dig.In嵌入的结构体中，如果希望函数的某个入参是可选，可以在 该struct的成员变量增肌tag 描述，比如： `optional:"true"`；
*  这样即使该成员没有提供privode()的依赖项生成，也可以使用。
*  
* func 函数的返回值可以是多个任何类型，还可包含一个 error 类型，也可是匿名嵌入的 dig.Out 结构体类型。
* 其中 dig.Out 嵌入到结构体时，结构体中的多个成员说明返回的是多个结果对象集合，后面可单独使用。
* 其实 Provide()是注册 使用依赖项产生对象（可能也是其他的依赖项） 函数，可能返回依赖项还继续依赖函数入参的依赖项。
*  
* 命名依赖： 某些使用场景可能会为同个数据类型初始化多个实例（默认dig对同一类型只会创建一个对象），比如读写数据句柄等。 需要在在provide(func)的func 返回类型中添加 tag: `name:"xn"` 来区分开。
#
* Invoke(func) ： 内部实现逻辑： 先实例化他们的依赖（函数入参,可能有多个入参）再运行 func。其中依赖项是 func的入参。依赖和依赖的依赖项一起按无序方式实例化的。
* Invoke(func) 运行逻辑是：在func入参被实例化再运行func。其实是最终触发产生和使用依赖项，而依赖项作为 func()的入参。
 
* 接口类型作为provide(func)中 func的返回值, 也可作为 func()的入参.

* 可以用于管理 全局变量等。比如一些单例的管理等。下面有实例来演示如何使用？
* ![依赖关系](依赖关系图.jpeg)
